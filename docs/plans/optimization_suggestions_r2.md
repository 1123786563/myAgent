# LedgerAlpha 优化建议 (Round 2) - v4.6 深度对齐版

基于对核心文档（白皮书、需求分析、详细设计、规格说明书）的最新研读，现针对系统集成、合规深度及主动交互提出以下 5 个深度优化建议：

## 1. 落地“多模态资产审计”逻辑 (F3.1.3)
*   **建议内容**：将采集端的“空间组 ID”逻辑深度引入审计流。当识别到多张照片属于同一实物资产时，审计 Agent 应将其聚合为单一“固定资产”条目进行核定，而非多个独立费用。
*   **技术实现**：升级 `AuditorAgent`，在接收到带 `group_id` 的分录建议时，自动检索同组的其他单据并进行逻辑合并。
*   **价值**：防止实物资产盘点中的重复入账，提升会计处理的严谨性。

## 2. 抽象“API-First 插件化”基类 (Connector Architecture)
*   **建议内容**：为对接外部 SaaS 生态（Shopify, Stripe）建立标准协议。
*   **技术实现**：在 `src/connectors/` 下完善 `BaseConnector` 抽象基类，统一处理 API 凭据解密、速率限制（Rate Limiting）及异常重试逻辑。
*   **价值**：降低后续集成新数据源的成本，确保系统的可扩展性。

## 3. 实现“主动证据追索”心跳任务 (F4.5 / Proactive Hub)
*   **建议内容**：针对“有钱无票”的情况，实现主动催办。
*   **技术实现**：在 `MatchEngine` 循环中增加扫描逻辑：若影子分录（银行流水）产生超过 24 小时仍未匹配到实体票据，则通过 `InteractionHub` 向老板发送“请拍照上传凭证”的提醒卡片。
*   **价值**：缩短证据链闭环时间，避免月底突击找票的窘境。

## 4. 补全“模拟报税沙箱”核心算法 (F3.3.2)
*   **建议内容**：在 Sentinel 模块中实现真实的税负预估。
*   **技术实现**：在 `SentinelAgent` 中增加 `_calculate_projected_tax()` 方法，基于当前月份已入账的进项/销项发票，自动估算增值税及附加税的预缴额。
*   **价值**：让老板实时感知税负压力，辅助经营决策（如是否需要在本月增加采购以抵扣）。

## 5. 实现“全账本长上下文”洞察接口 (白皮书 2.5)
*   **建议内容**：赋予 Agent “历史记忆”。
*   **技术实现**：在 `DBHelper` 中新增 `get_historical_trend(vendor)` 接口，返回该供应商过去 12 个月的分类偏好、单价波动及交易频率统计，作为 Context 注入 L2 推理层。
*   **价值**：利用 LLM 的长上下文能力发现跨年度的财务规律，识别异常偏离。

---
建议提交人：无敌大旋风 (LedgerAlpha 首席架构小狗)
日期：2026-01-31
